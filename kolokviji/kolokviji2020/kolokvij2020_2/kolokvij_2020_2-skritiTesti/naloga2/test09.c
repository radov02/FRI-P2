
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

#include "naloga2.h"

#define MAX_ST_NASLOVOV 1000000

Vozlisce* izdelaj(int* t, long* naslovi, int* stNaslovov) {
    if (*t < 0) {
        return NULL;
    }
    Vozlisce* v = malloc(sizeof(Vozlisce));
    naslovi[(*stNaslovov)++] = (long) v;
    v->podatek = *t;
    v->naslednje = izdelaj(t + 1, naslovi, stNaslovov);
    return v;
}

void izpisi(Vozlisce* v) {
    printf("[");
    Vozlisce* p = v;
    while (p != NULL) {
        if (p != v) {
            printf(", ");
        }
        printf("%d", p->podatek);
        p = p->naslednje;
    }
    printf("]\n");
}

void pocisti(Vozlisce* v) {
    if (v != NULL) {
        pocisti(v->naslednje);
        free(v);
    }
}

int primerjalnik(const void* pa, const void* pb) {
    long a = *(long*) pa;
    long b = *(long*) pb;
    return (a < b) ? (-1) : ((a > b) ? 1 : 0);
}

bool preveri(Vozlisce* seznam, long* naslovi, int stNaslovov) {
    Vozlisce* p = seznam;
    while (p != NULL) {
        long naslov = (long) p;
        if (bsearch(&naslov, naslovi, stNaslovov, sizeof(long), primerjalnik) != NULL) {
            return false;
        }
        p = p->naslednje;
    }
    return true;
}

int __main__() {
    int* t[] = {
        (int[]) {5749, 9080, 1838, 5516, 1486, 5463, 4626, 3085, 57, 4915, 5112, 1330, 2970, 3416, 6955, 9753, 3274, 385, 2344, 6496, 369, 1639, 7248, 4982, 2224, 2940, 4080, 9685, 6540, 7492, 2030, 1105, 4472, 4357, 322, 3878, 1074, 3804, 4668, 6147, 8674, 9169, 438, 606, 2324, 719, 8542, 1234, 4154, 8093, 3082, 6718, 8025, 6464, 6270, 2742, 242, 8932, 3094, 1894, 32, 9060, 8002, 8911, 6744, 4344, 7645, 9454, 6, 9940, 1018, 2804, 9047, 3712, 3243, 3629, 8383, 9902, 546, 5359, 7592, 8296, 5576, 1222, 2165, 5077, 5640, 4993, 7451, 5792, 4317, 8040, 9743, 3413, 993, 1965, 9814, 4057, 1844, 1647, 3853, 5525, 4162, 7399, 4486, 4725, 7240, 2583, 6542, 2513, 9350, 1231, 9872, 4026, 1961, 928, 4381, 3863, 7063, 1321, 7407, 9116, 2307, 6433, 7570, 3199, 5121, 381, 6954, 6492, 7707, 4870, 8443, 1946, 8701, 2384, 6507, 4720, 2612, 262, 7299, 4309, 8555, 9650, 9044, 274, 2181, 7849, 8605, 547, 9505, 9337, 1090, 3130, 7581, 2863, 7938, 8223, 7844, 2163, 7655, 6970, 9221, 9364, 5163, 2778, 9932, 304, 9908, 6320, 3595, 8976, 1572, 8554, 7868, 1407, 9246, 5324, 6825, 8086, 3976, 4093, 4426, 8726, 2651, 3751, 6152, 5419, 4456, 8143, 1265, 7459, 2284, 2450, 9528, 2660, 2959, 4024, 7329, 2197, 6302, 8792, 6643, 8809, 2459, 8782, 904, 8374, 2141, 3389, 214, 7266, 9379, 7230, 8118, 5923, 513, 4291, 3845, 3360, 5452, 9322, 8435, 6389, 7171, 2040, 2014, 8652, 5964, 116, 7820, 5940, 5878, 2937, 9015, 9359, 7076, 9109, 1855, 7148, 2189, 5933, 7864, 1646, 5996, 9444, 7400, 5927, 4294, 914, 9349, 872, 9953, 9579, 8821, 3114, 7943, 1511, 8049, 5268, 6653, 605, 2488, 1176, 363, 6414, 3120, 3912, 6592, 3435, 2617, 8208, 6288, 5507, 710, 551, 367, 9600, 6775, 4829, 3339, 9913, 6738, 8723, 883, 4988, 9820, 9833, 9106, 5310, 3260, 6642, 7697, 8512, 2515, 8020, 8814, 5362, 58, 4811, 2721, 6175, 940, 8832, 9644, 8058, 594, 227, 3875, 5702, 9481, 6873, 2510, 6403, 8164, 3758, 5674, 6792, 9581, 8767, 1689, 2858, 4330, 7826, 336, 4125, 680, 4955, 8033, 9636, 5733, 2365, 3036, 975, 4219, 8525, 3397, 1611, 5417, 9766, 782, 9825, 7049, 20, 7183, 1575, 286, 4764, 4648, 9150, 9865, 1994, 5992, 1766, 848, 8341, 1673, 653, 4921, 8320, 445, 8306, 8444, 5665, 1111, 8251, 9291, 4032, 8775, 3076, 6188, 3711, 2525, 7794, 2554, 46, 845, 7894, 6742, 6179, 4860, 7357, 8739, 9061, 7467, 9892, 6931, 7800, 9297, 8038, 7174, 220, 6417, 8417, 7093, 3555, 7998, 2292, 7097, 2121, 9265, 7976, 3213, 3420, 6506, 6342, 7422, 9622, 5458, 5966, 8133, 6376, 8680, 2433, 7596, 6559, 16, 6471, 4709, 6372, 5299, 2196, 8580, 7156, 7249, 4569, 1623, 1310, 761, 6470, 6084, 8582, 80, 2847, 866, 5385, 3921, 5445, 5098, 9223, 8112, 6500, 2938, 7866, 3821, 9928, 1023, 7822, 1778, 2187, 2963, 3129, 411, 6929, 9883, 435, 9963, 9256, 3609, 4520, 5331, 340, 623, 8108, 6253, 784, 603, 9842, 356, 6419, 1388, 8035, 2412, 5949, 4574, 6733, 9331, 3794, 5731, 6457, 3652, 3250, 5424, 769, 3072, 9024, 3352, 7489, 1143, 8061, 1920, 588, 8890, 9262, 6071, 7257, 3291, 8954, 966, 4252, 2962, 743, 5858, 7470, 2119, 6656, 1975, 8759, 110, 2695, 3105, 6041, 9240, 548, 6664, 7747, 5621, 3750, 1935, 4322, 3421, 3193, 8669, 4365, 1088, 7318, 3450, 4523, 4550, 8304, 4820, 3441, 5943, 9923, 7132, 5159, 8928, 138, 6689, 4418, 724, 6330, 3602, 893, 8866, 3725, 1821, 6795, 8314, 9354, 1467, 3620, 4422, 7200, 109, 3865, 0, 7693, 751, 8590, 6159, 1042, 9034, 3702, 3991, 2299, 4774, 2774, 3464, 1275, 4675, 5115, 5315, 6657, 509, 1760, 7224, 6039, 8933, 9404, 9202, 6522, 4104, 5160, 8630, 7020, 7832, 270, 3693, 8616, 7918, 7559, 1984, 8499, 6408, 8608, 3494, 4481, 186, 8651, 2071, 4519, 5693, 2277, 3519, 464, 8372, 8505, 1091, 4175, 1441, 4036, 1609, 189, 2777, 3769, 1677, 3945, 1419, 4617, 5339, 1099, 6486, 4864, 6877, 1273, 992, 4835, 5248, 663, 5574, 4935, 6309, 611, 6459, 6702, 8218, 4931, 2417, 1342, 4790, 350, 9049, 169, 2718, 4609, 25, 1477, 5866, 9263, 7096, 7590, 87, 7839, 121, 9275, 7482, 4553, 2527, 5343, 1916, 8968, 7443, 8494, 5989, 3031, 268, 6441, 2745, 6573, 3610, 7013, 60, 8624, 2329, 9775, 6105, 8786, 8237, 3402, 2917, 7328, 7953, 3303, 9181, 3810, 5408, 5246, 9030, 5936, 5955, 8294, 1077, 6878, 8282, 4473, 99, 8029, 2373, 1636, 7342, 9373, 3526, 6498, 4585, 7026, 2594, 9593, 8673, 5318, 7078, 6599, 7164, 5326, 1224, 8470, 6790, 1010, 2142, 8589, 1761, 8301, 9171, 5257, 9100, 9529, 44, 3894, 5482, 2285, 8022, 2021, 8577, 9147, 9428, 430, 882, 4022, 936, 5129, 7487, 8482, 9266, 5395, 6479, 9518, 8335, 9946, 7921, 718, 5743, 7685, 6013, 6789, 3064, 1443, 6378, 7796, 745, 615, 1633, 5400, 2350, 5808, 9351, 6411, 4704, 38, 4096, 3895, 1478, 4998, 8533, 8172, 4638, 10, 5912, 2369, 4272, 3388, 8281, 2576, 1498, 942, 8293, 776, 7243, -1},
        (int[]) {6461, 9630, 8088, 4517, 9335, 1479, 6949, 8210, 2132, 1895, 7648, 787, 352, 6658, 1124, 8929, 2452, 2253, 5541, 4955, 1198, 6423, 5310, 8522, 8307, 9910, 53, 4860, 870, 2495, 2438, 7215, 9687, 7338, 9948, 7920, 3557, 7148, 4809, 7804, 770, 9793, 1048, 1539, 1219, 3581, 8221, 4101, 4065, 4870, 1822, 5659, 4325, 1612, 1838, 6481, 420, 4457, 499, 1120, 4884, 7044, 6506, 6127, 4963, 3285, 4738, 8331, 3161, 1734, 1912, 6189, 7387, 9809, 5057, 1508, 8104, 2299, 36, 5802, 952, 5055, 7962, 2661, 7318, 1215, 1237, 3995, 2730, 2296, 5151, 6400, 9821, 9689, 3698, 4174, 7923, 4329, 4138, 9869, 594, 9360, 8748, 4440, 4984, 5857, 1194, 1960, 8682, 2258, 1799, 8947, 2940, 8698, 8048, 5221, 5186, 9962, 4350, 6849, 108, 8253, 1298, 547, 9133, 8338, 4898, 6518, 9511, 5197, 2336, 8285, 907, 2203, 4675, 1559, 8071, 7332, 5616, 3691, 1187, 9744, 7602, 5544, 1058, 3301, 8753, 1648, 2152, 1430, 6096, 779, 342, 5576, 3526, 9504, 1094, 8752, 5110, 6310, 3582, 8137, 3754, 8291, 4490, 3015, 668, 7484, 256, 2195, 4208, 6578, 3753, 8797, 5094, 8908, 5940, 8426, 957, 7320, 3121, 4553, 9129, 9109, 3869, 4232, 6894, 8026, 6896, 9035, 6447, 1074, 4029, 9134, 9355, 8342, 4902, 6380, 8159, 5811, 363, 540, 9413, 2628, 3990, 2641, 1482, 8885, 2899, 1963, 6045, 866, 1933, 780, 7324, 2134, 7251, 3056, 3189, 5523, 2795, 8616, 3193, 1806, 2727, 3812, 895, 2973, 583, 3699, 9250, 7178, 6202, 8298, 7921, 7393, 2098, 5912, 8644, 2884, 7354, 6136, 6733, 4242, 7009, 9245, 7852, 9657, 5628, 2357, 6878, 6111, 4262, 9173, 4426, 5565, 777, 8483, 1193, 2685, 5239, 2887, 5461, 2301, 9778, 4693, 3002, 9767, 9774, 5744, 7403, 4817, 140, 5384, 85, 3816, 4207, 584, 1037, 8985, 9230, 8084, 60, 7074, 2744, 3739, 8306, 2208, 7867, 3414, 5473, 5610, 5010, 964, 8251, 5119, 4279, 3811, 8880, 2424, 8652, 160, 632, 6500, 2584, 2576, 7933, 5431, 8532, 1719, 3130, 636, 8726, 7144, 5676, 2579, 3307, 1585, 6010, 8890, 8801, 4273, 7195, 9487, 1170, 4198, 3388, 9582, 5810, 1121, 8380, 3400, 4711, 1807, 9665, 7087, 2913, 6389, 6372, 7570, 7683, 1645, 8996, 2079, 8563, 4415, 5235, 408, 8055, 6921, 5356, 4202, 3194, 8925, 9807, 3438, 1294, 9353, 9926, 3142, 5267, 2222, 9670, 5569, 9551, 9908, 5188, 2036, 2035, 7573, 123, 4151, 6401, 6350, 5067, 7442, 9153, 1517, 1966, 6082, 4857, 7, 4952, 3954, 3254, 1524, 0, 9847, 243, 1749, 61, 5214, 7064, 3766, 924, 1732, 5543, 1763, 240, 8595, 8014, 8777, 9255, 2819, 8183, 4538, 2860, 5056, 7865, 402, 41, 3114, 8154, 5168, 7331, 9198, 6232, 4644, 1263, 5386, 6274, 4391, 5332, 8856, 3326, 1467, 8064, 4904, 2927, 4824, 8557, 7326, 2071, 4424, 4603, 4742, 9011, 2648, 722, 1043, 9977, 135, 9545, 1485, 2802, 101, 8368, 6570, 8391, 3514, 2687, 1419, 7204, 2443, 1671, 6663, 7311, 9175, 3073, 5173, 7751, 6745, 4534, 5508, 7938, 6975, 6556, 3473, 7951, 7626, 7001, 6006, 7236, 8874, 1355, 5623, 2595, 9652, 2824, 4302, 7888, 2910, 1320, 5549, 6346, 7980, 8112, 6005, 6335, 9288, 7507, 3641, 8476, 2979, 719, 8406, 5478, 595, 4395, 5030, 2517, 4633, 7515, 9512, 7200, 7039, 2218, 8065, 3399, 5553, 1278, 4658, 5401, 6395, 8037, 1728, 4296, 6929, 8023, 247, 718, 5395, 7744, 911, 6837, 8817, 505, 4466, 3511, 2625, 2275, 5099, 3974, 1089, 2978, 8519, 6013, 8265, 458, 3612, 5187, 8822, 3758, 9229, 9663, 4261, 2786, 9684, 2865, 4536, 496, 6104, 1307, 7738, 7119, 3134, 7472, 5808, 4876, 9682, 5999, 6601, 4720, 9207, 1630, 7540, 1956, 9256, 5846, 3492, 1637, 6956, 5736, 7958, 4640, 2790, 774, 6725, 5705, 2279, 9946, 7217, 4323, 9583, 9581, 3826, 2062, 6859, 5989, 5034, 5678, 601, 6210, 6035, 9474, 4853, 3392, 8975, 6301, 4614, 1272, 6885, 8315, 946, 8937, 2932, 7783, 6938, 9293, 2852, 8724, 7883, 8479, 4420, 1982, 4946, 2271, 6798, 1785, 9577, 1305, 5241, 3637, 5425, 7142, 6492, 133, 3607, 3094, 6186, 1876, 6789, 6119, 188, 4481, 745, 9123, 4496, 7118, 6687, 5231, 3718, 9107, 3713, 9573, 6345, 9812, 9445, 3933, 4188, 572, 701, 8366, 551, 7715, 6847, 289, 2621, 4707, 9495, 1859, 3066, 373, 9825, 1834, 8016, 6495, 5858, 2830, 220, 6433, 2321, 5945, 7814, 8899, 6021, 5133, 9638, 4351, 8239, 184, 726, 1173, 6254, 3233, 4562, 6064, 4734, 8378, 1814, 1465, 6545, 9226, 6615, 7979, 5949, 6334, 8170, 2420, 6574, 8579, 5695, 4362, 5524, 2994, 5797, 148, 8516, 9299, 9771, 3978, 2510, 2966, 5908, 5759, 7514, 8385, 4619, 5199, 4856, 3860, 3932, 5764, 6409, 1258, 8630, 332, 2961, 5114, 5476, 7952, 3314, 3548, 8517, 2529, 5884, 7576, 9598, 320, 7133, 3325, 3903, 398, 6277, 9258, 8848, 3939, 8259, 2119, 549, 9128, 8327, 7565, 8036, 1326, 3469, 3897, 1917, 5037, 5725, 5750, 37, 9199, 3005, 8754, 5029, 4540, 6563, 2914, 1181, 1926, 9187, 1923, 1965, 6613, 5786, 2536, 9756, 5096, 9645, 5366, 1556, 871, 3668, 9200, 1833, 5455, -1},
    };
    int n = sizeof(t) / sizeof(int*);

    Vozlisce** seznami = malloc(n * sizeof(Vozlisce*));
    long* naslovi = malloc(MAX_ST_NASLOVOV * sizeof(long));
    int stNaslovov = 0;
    for (int i = 0;  i < n;  i++) {
        seznami[i] = izdelaj(t[i], naslovi, &stNaslovov);
    }
    qsort(naslovi, stNaslovov, sizeof(long), primerjalnik);

    Vozlisce* prepleten = prepleti(seznami, n);
    if (!preveri(prepleten, naslovi, stNaslovov)) {
        printf("NAPAKA!\n");
        printf("Vsa vozlisca prepletenega seznama morajo biti kopije vozlisc originalnih seznamov.\n");
    }
    izpisi(prepleten);
    pocisti(prepleten);

    for (int i = 0;  i < n;  i++) {
        pocisti(seznami[i]);
    }
    free(seznami);
    free(naslovi);

    exit(0);
    return 0;
}
